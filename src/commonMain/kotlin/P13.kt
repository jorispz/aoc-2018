// First crash at 58,93
// Last cart standing at 91,72
val p13 = fun() {

    val world = World(input_13.lines().drop(1))
    while (world.tick()) {
//         world.draw()
    }

}

class World(input: List<String>) {
    private val height = input.size
    private val width = input.maxBy { it.length }!!.length
    private val map = Array(height) { CharArray(width) }
    private val carts = mutableListOf<Cart>()
    private var firstCrash = true

    init {
        input.forEachIndexed { y, line ->
            line.forEachIndexed { x, c ->
                when (c) {
                    '^' -> {
                        map[x][y] = '|'
                        carts.add(Cart(x, y, Heading.N))
                    }
                    'v' -> {
                        map[x][y] = '|'
                        carts.add(Cart(x, y, Heading.S))
                    }
                    '>' -> {
                        map[x][y] = '-'
                        carts.add(Cart(x, y, Heading.E))
                    }
                    '<' -> {
                        map[x][y] = '-'
                        carts.add(Cart(x, y, Heading.W))
                    }
                    else -> map[x][y] = c

                }

            }
        }
    }

    fun tick(): Boolean {
        carts.sortWith(compareBy(Cart::y, Cart::x))
        carts.forEach { cart ->
            if (!cart.crashed) {
                cart.move(map)
                carts.without(cart).filter { other -> !other.crashed && other.x == cart.x && other.y == cart.y }
                    .whenNotEmpty { crashedInto ->
                        (crashedInto + cart).forEach {
                            it.crashed = true
                        }
                        if (firstCrash) {
                            println("First crash at ${cart.x},${cart.y}")
                            firstCrash = false
                        }
                    }
            }
        }

        return if (carts.count { !it.crashed } == 1) {
            val lastStanding = carts.single { !it.crashed }
            println("Last cart standing at ${lastStanding.x},${lastStanding.y}")
            false
        } else {
            true
        }

    }


    fun draw() {
        val sb = StringBuilder((height + 1) * width)
        for (y in 0 until height) {
            for (x in 0 until width) {
                val cart = carts.filter { it.x == x && it.y == y }
                when {
                    cart.size == 1 -> sb.append(
                        when (cart.single().heading) {
                            Heading.N -> "^"
                            Heading.W -> "<"
                            Heading.S -> "v"
                            Heading.E -> ">"
                        }
                    )
                    else -> sb.append(map[x][y])
                }
            }
            sb.append("\n")
        }
        println(sb.toString())
    }


}

class Cart(
    var x: Int,
    var y: Int,
    var heading: Heading,
    var crashed: Boolean = false
) {


    private val turns = sequenceOf(Turn.LEFT, Turn.STRAIGHT, Turn.RIGHT).infinite().iterator()

    fun move(map: Array<CharArray>) {
        when (heading) {
            Heading.N -> y--
            Heading.E -> x++
            Heading.S -> y++
            Heading.W -> x--
        }

        heading = when (map[x][y]) {
            '+' -> {
                when (turns.next()) {
                    Turn.LEFT -> heading.left()
                    Turn.STRAIGHT -> heading
                    Turn.RIGHT -> heading.right()
                    Turn.REVERSE -> error("Shouldn't happen")
                }
            }
            '/' -> {
                when (heading) {
                    Heading.N -> Heading.E
                    Heading.W -> Heading.S
                    Heading.S -> Heading.W
                    Heading.E -> Heading.N
                }
            }
            '\\' -> {
                when (heading) {
                    Heading.N -> Heading.W
                    Heading.W -> Heading.N
                    Heading.S -> Heading.E
                    Heading.E -> Heading.S
                }
            }
            else -> heading
        }

    }
}


val input_13_test = """
/>-<\
|   |
| /<+-\
| | | v
\>+</ |
  |   ^
  \<->/"""

val input_13 = """
                                                     /------------------------------------------------------\                  /---------------\
  /--------------------------------------------------+--------------------------------------------------\   |                  |               |
  |                                  /---------------+----------------------------------\               |   |                  |               |
  |                  /---------------+---------\     |                                  |               |   |                  |               |
  |                  |               |         |     |       /--------------------------+---------------+---+--------------\   |               |
  |                  |  /------------+---------+-----+-------+-\/-----------------------+--\            |   |              |   |               |
  |   /--------\     |  |            |         |     |       | ||                 /-----+--+------------+---+----\         |   |               |
  |   |        |     |  |            |         |     |       | ||             /---+-----+--+------------+---+----+-\       |   |               |
  |   |        |     |  |            |         |/----+-------+-++-------------+---+-----+--+------------+---+----+-+-\     |   |               |
  |   |        |     |  |         /--+---------++----+-------+-++-------------+---+-----+--+------------+---+\   | | |     |   |               |
  | /-+--------+-----+--+---------+--+----\    ||    | /-----+-++-------------+---+-----+--+-\          |   ||   | | |     |   |   /-----------+-\
  | | |        |     |  |         |  |    |    ||    | |   /-+-++-------------+---+-----+--+-+----------+---++---+-+-+-----+---+---+---------\ | |
  | | |        | /---+--+---------+--+----+----++----+-+---+\| ||             |   |     |  | |          |   ||   | | |     |   |   |         | | |
  | | |        | |   |  |    /----+--+----+----++----+-+---+++-++-------------+---+-----+--+-+----------+---++---+-+-+----\|   \---+---------+-/ |
  | | |        | |   |  |    |   /+--+----+----++----+\|   ||| ||      /------+---+-----+--+-+----------+---++---+-+-+----++-------+--\      |   |
  | | |        | |   |  |    |  /++--+----+----++----+++---+++-++------+------+---+-----+--+\|          |   ||   | | |    ||       |  |      |   ^
  | | |    /---+-+---+--+\   |  |||  |    |    ||    |||   ||| ||      |    /-+---+-----+--+++-----\    |   ||   | | |    ||       |  |      |   |
  | | |    |   | |   |  ||   |  |||  |    |    ||    |||   ||| ||      |    | |   |   /-+--+++-----+----+---++---+-+\|    ||       |  |      |   |
  | | |    |   | |   |  || /-+--+++--+----+----++----+++---+++-++------+----+-+---+---+-+--+++-----+----+---++--\| |||    ||       | /+------+---+---\
  | | |    |   | |  /+--++-+-+--+++--+----+----++--\ |||   ||| ||/-----+----+-+---+--\| |  |||     |    |   ||  || |||   /++-------+-++-----\|   |   |
  | | |    |   | |  ||  || | |  |||  |    |    ||  | |||   ||| |\+-----+----+-+---+--++-+--/||     |    |  /++--++-+++---+++-------+-++----\||   |   |
  | | |    |   | |  || /++-+-+--+++--+----+----++--+-+++---+++\| |     |    | |   |  || |   ||     |    |  |||  || |||   |||       | ||    |||   |   |
  | | |    |   | |  || ||| | |  |||  |    |    ||  | |||   ||||| |     |   /+-+---+--++-+---++-----+----+--+++--++-+++---+++-------+-++----+++--\|   |
  | | |    |   | |  || ||| | |  |||  |    |  /-++--+-+++---+++++-+-----+---++-+---+--++-+---++-----+----+--+++--++-+++--\|||       | ||    |||  ||   |
  | | |    |   | |  || ||| | |  |||  |   /+--+-++--+-+++\  ||||| |     |   || |   | /++-+---++-----+----+--+++--++-+++--++++-------+-++----+++--++\  |
  | | |  /-+---+-+--++-+++-+\|  |||  |   ||  | ||  | ||||  ||||| |     |   || |   | ||| |   ||     |    |  |||  || |||  ||||       | ||    |||  |||  |
  | | |  | |   | |  || ||| |||  |||  |   ||  | ||  | ||||  ||||| |     |   || |   | ||| |   ||     |    |  |||  || |||  ||||   /---+-++--\ |||  |||  |
  | | |  | |   | |/-++-+++-+++-\|||  |   ||  | ||/-+-++++--+++++-+-----+---++-+---+-+++-+---++-----+----+--+++--++-+++\ ||||   |   | ||  | |||  |||  |
  | | |  | |   | || || ||| ||| ||||  |/--++--+-+++-+-++++--+++++-+-----+---++-+---+-+++-+---++-----+--\ |  |||  || |||| ||||   |   | ||  | |||  |||  |
  | | |  | |   | || || ||| ||| ||||  ||  ||  | ||| | ||\+--+++++-+-----+---++-+---+-+++-+---+/     |  | |  |||  || |||| ||v|   |   | ||  | |||  |||  |
  | | |  | | /-+-++-++-+++-+++-++++--++--++--+-+++-+-++-+--+++++-+-----+---++-+---+-+++-+---+---\  |  | |  |||  || |||| |\++---+---+-++--+-+/|  |||  |
  | | | /+-+-+-+-++-++-+++-+++-++++--++--++--+-+++-+-++-+--+++++-+-----+---++-+---+-+++-+---+---+--+--+\|  |||  || ||||/+-++---+---+-++\ | | |  |||  |
  | |/+-++-+-+-+-++-++-+++-+++-++++--++--++--+-+++-+-++-+--+++++-+-----+\  || |  /+-+++-+---+---+--+--+++--+++--++-++++++-++---+---+-+++-+-+-+-\|||  |
  | ||| || | | |/++-++-+++-+++-++++--++--++--+-+++-+-++-+--+++++-+-----++--++-+--++-+++-+---+---+--+-\|||  |||  || |||||| ||   |   | ||| | | | ||||  |
  | ||| || | | |||| || ||| ||| |||| /++--++--+-+++-+-++-+\ ||||| | /---++--++-+--++-+++-+---+---+--+-++++--+++--++-++++++\||   |   | ||| | | | ||||  |
  | ||| || | | |||| ||/+++-+++-++++-+++--++--+-+++-+\|| || ||||| | |   ||  || |  || ||| |   |   |  | ||||  |||  || |||||||||   |   | ||| | | | ||||  |
  | ||| || | | |||| |||||| ||| |||| |||  ||  | ||| |||| ||/+++++-+-+---++--++-+--++-+++-+---+---+--+-++++--+++--++-+++++++++---+---+-+++-+-+-+-++++\ |
  | ||| || | | |||\-++++++-+++-/||| |||  ||  | ||| |||| |||||||| |/+---++--++-+--++-+++-+---+---+--+-++++--+++-\|| |||||||||   |   | ||| | | | ||||| |
  | ||| || | | |||  |||||| |||  ||| |||  ||  | ||| |||| |||||||| |||   ||  || |  || ||| |   |   | /+-++++--+++-+++-+++++++++---+---+-+++-+-+-+\||||| |
  | ||| || | \-+++--++++++-+++--+++-+++--++--+-+++-++++-++++++++-+++---++--++-+--++-+++-+---+---/ || ||||  ||| ||| |||||||||   |   | ||| | | ||||||| |
  | ||| || |   |||  |||||| |||  ||| ||| /++--+-+++-++++-++++++++-+++---++--++-+--++-+++-+---+-----++-++++--+++\||| |||||||||   |   | ||| | | ||||||| |
  | ||| || |   |||  ||||\+-+++--+++-+++-+++--+-+++-++++-+++++++/ |||   ||  || |  || ||| |   |     || ||||  ||||||| |||||||||   |   | ||| | | ||||||| |
  | ||| || |   ||\--++++-+-+++--+++-+++-+++--+-+++-++++-++++/||  |||   ||  || |  || ||| |   | /---++-++++--+++++++-+++++++++--\|   | ||| | | ||||||| |
  | ||| || |   ||   |||| | |||  ||| ||| |\+--+-+++-++++-/||| ||  |||   ||  || |  || \++-+---+-+---++-++++--+++++++-+++++++++--++---+-+++-+-+-+++++/| |
  | ||| || |   ||   |||| | |||  ||| ||| | |  | ||| ||||  ||| ||  |||   ||  || |  ||  || |   | |   ||/++++--+++++++-+++++++++--++--\| ||| | | ||||| | |
  | ||| || |   ||   |||| | |||  ||| ||| | |  | ||| ||||  ||| ||  |||   ||  || |  ||  |v |   | |   |||||||  ||||||| |||||||||  ||  || ||| | | ||||| | |
/-+-+++-++-+---++---++++-+-+++--+++-+++-+-+--+-+++-++++--+++-++--+++---++--++-+--++--++-+---+-+-\ |||||||  ||||||| |||||||||  ||  || ||| | | ||||| | |
| | ||| || \---++---++++-//+++--+++-+++-+-+--+-+++-++++-\||| ||  \++---++--++-+--++--/| |   | | | |||||||  ||||||| |||||||||  ||  || ||| | | ||||| | |
| | ||| ||     ||   ||||  ||||  ||| ||| | |  | ||| |||| |||| ||   ||   ||  |\-+--++---+-+---+-+-+-+/|||||  ||||||| |||||||||  ||  || ||| | | ||||| | |
| | ||| ||     ||   ||||  ||||  ||| ||| | |  | ||| |||| |||| ||   ||   ||  |  ^  ||   | | /-+-+-+-+-+++++--+++++++-+++++++++--++--++-+++-+-+-+++++\| |
| | ||| ||     ||   ||||  ||||/-+++-+++-+-+--+-+++-++++-++++-++---++---++--+--+--++--\| |/+-+-+-+-+\|||||  ||||||| |||||||||  ||  || ||| | | ||||||| |
| | ||| ||     || /-++++--+++++-+++-+++-+-+--+\||| |||| |||| ||   ||   ||  |  |  ||  || ||| | \-+-+++++++--+++++++-+++++++++--/|  || ||| | | ||||||| |
| | ||| ||     || | ||||  ||||| ||| ||| | |  ||||| |||| |||| ||   ||   ||  | /+--++--++-+++-+---+-+++++++--+++++++-+++++++++---+--++\||| | | ||||||| |
|/+-+++-++-----++-+-++++--+++++-+++-+++-+-+--+++++-++++-++++-++---++--\||  | ||  ||  || ||| |   | |||||||  ||||||| |||||||||   |  |||||| | | ||||||| |
||| ||| ||     || | ||||  ||||| ||| ||| | |  ||||| |||| |||| ||   ||/-+++--+-++--++--++-+++-+---+-+++++++--+++++++-+++++++++---+-\|||||| | | ||||||| |
||| ||| || /---++-+-++++--+++++-+++-+++\| |  ||||| |||| |||| ||   ||| |||  | ||  ||  || ||| |   | |||||||  ||||||| |||||||||   | ||||||| | | ||||||| |
||| ||| |\-+---++-+-++++--++/|| ||| ||||| |  |||\+-++++-++++-++---+++-+++--+-++--++--++-+++-+---+-+++++++--+++++++-++/||||||   | ||||||| | | ||||||| |
||| ||| |  |   || | ||||  || || ||| ||||| |  ||| | |||| |||| || /-+++-+++--+-++--++--++-+++-+---+-+++++++--+++++++\|| ||||||   | ||||||| | | ||||||| |
||| ||| |  |   || | ||||  || || ||\-+++++-+--+++-+-++++-++++-++-+-+++-+++--+-++--++--++-+++-+-<-+-+++++++--++/||||||| ||||||   | ||||\++-+-+-+++++++-/
||| ||| |  |   || | ||||  || || ||  ||||| |  ||| | |||| |||| || | ||| |||/-+-++--++--++-+++\|   | |||||||  || ||||||| ||||||   | |||| || | | |||||||
||| ||| |  |  /++-+-++++--++-++-++--+++++-+--+++-+-++++-++++-++-+-+++-++++-+-++--++\ || |||||   | |||||||  || ||||||| ||||||   | |||| || | | |||||||
||| ||| |  |  ||| | ||||  || || ||  ||||| |  ||| | |||| |||| || | ||| |||| | ||  ||| || |||||   | ||||||| /++-+++++++-++++++---+-++++-++-+-+-+++++++-\
||| ||\-+--+--+/| | ||||  || || ||  ||||| |  ||| | |||| |||| || | ||| |||| | ||  ||| || |||||   | ||||||| ||| ||||||| ||||||   | ||\+-++-+-+-++++/|| |
||| ||  |  |  | | \-++++--++-++-++--+++++-+--+/| | |||| |||| || | ||| |||| | ||  ||| || |||||   | ||||||| ||| ||||||| ||||||   | || | || | | |||| || |
||| ||  |  |  | |   ||||  || || ||  ||||| |  | | | |||| |||| || | ||| |||| | \+--+++-++-+++++---+-+++++++-+++-+++++++-++++++---+-++-/ || | | |||| || |
||v \+--+--+--+-+---++++--++-++-++--+++++-/  | | | |||| |||| || | ||| |||| |  |  \++-++-+++++---+<+++++++-+++-+++++++-++++++---+-++---++-+-+-++/| || |
|||  \--+--+--+-+---++++--++-++-++--+++++----+-+-+-++++-++++-++-+-+++-++/| |  |   || || |||||   | ||||||| ||| ||||||| ||||||   | ||   || | | || | || |
|||     |  |  | |   ||||  || || ||  |||||    | | | |||| |||| || | ||| || | |  |/--++-++-+++++---+-+++++++-+++-+++++++-++++++---+-++\  || | | || | || |
|||     |  |  | |   ||||  || || ||  |||||    | | | |||| |||| || | ||| || | |  \+--++-++-+++++---+-+++++++-+++-+++++/| ||||||   | |||  || | | || | || |
|||     |  |  | |   ||||  || || ||  |||||    | | | |||| |||| || \-+++-++-+-+---+--++-++-+++++---+-+++++++-+++-++++/ | ||||||   | |||  || | | || | || |
|||     |  | /+-+---++++--++-++-++--+++++----+-+-+\|||| |||| ||   ||| || | |   |  || || |||||   | ||||||| ||| ||||  | ||||||   | |||  || | | || | || |
||| /---+--+-++-+---++++--++-++\||  |||||    | | |||||| |||| || /-+++-++-+-+\  |  || || |||||  /+-+++++++-+++-++++-\| ||||||   | |||  || | | || | || |
||| |   |  | || |   ||||  || |||||  |||||    | | |||||| |||| || | ||| || | ||  |  || |\-+++++--++-+++++++-+++-++++-+/ ||||||   | |||  || | | || | || |
||| |   |  | || |   ||||  |\-+++++--+++++----+-+-++++++-++++-++-+-+++-++-+-++--+--++-+--+++++--++-+++++++-+++-++/| |  ||||||   | |||  || | | || | || |
||| |   |  | || |   ||||  |  |||||/-+++++----+-+\|||||| |||| || | ||| || | ||  |  || |  |||||  ||/+++++++-+++-++-+-+--++++++---+-+++--++-+\| || | || |
||| |   | /+-++-+---++++--+--++++++-+++++----+-++++++++\|||\-++-+-+++-++-+-++--+--++-+--+++++--++++++++++-+++-++-+-+--++++++---+-+++--++-+++-/| | || |
||| |   | || || |   ||||  |  |||||| |||||/---+-++++++++++++--++\| |||/++-+-++--+--++-+--+++++--++++++++++-+++-++-+-+--++++++---+-+++--++\|||  | | || |
||| |   | || || |   ||||  |  |||||| ||||||   | ||||||||||||  |||| |||||| | ||  |  || |  |\+++--++++/||||| ||| ||/+-+--++++++\  | |||  ||||||  | | || |
||| |   | || || |   ||||  |  |||||| ||||||   | ||||||||||||  |||| |||||| | ||  |  || |  | |||  |||| |||||/+++-++++-+--+++++++--+-+++--++++++--+-+\|| |
||| |   | || || |   ||||  |  |||||| ||||||   | ||||||||||||  |||| |||||| | ||  |  || |  | |||  |||| ||||||||| |||| |  |||||||  | |||  ||||||  | |||| |
||| |   | || \+-+---++++--+--++++++-++++++---+-+++/||||||||  |||| |||||| | ||  |  || |  | |||  \+++-+++++++++-++++-/  |||||||  | |||  ||||||  | |||| |
||| |   | ||  | |   ||||  |  |||||| ||||||   | ||| ||||||||  |||| |||||| | ||  |  \+-+--+-+++---+++-+++++++++-+++/  /-+++++++--+-+++--++++++--+-++++\|
||| |   | ||  | |   ||||  |  |||||| ||||||   | ||| ||||||||  |||| |||||| | ||  |   | |  | |||   ||| ||||||||| |||   | |||||||  | |||  ||||||  | ||||||
||| |   | ||  | |   ||||  |  |||||| ||||||   | ||| ||||||||  |||| |||||| | ||  |   | |  | |||   ||| |||||||\+-+++---+-+++++++--+-+++--+++++/  | ||||||
||| |   | ||  | |   ||||  |  |||||| ||||||   | ||\-++++++++--++++-++++++-+-++--+---+-+--+-+++---+++-+++++++-+-+++---+-/||||||  | |||  |||||   | ||||||
||| |   | ||  | |   ||||  |  |||||| ||||||   | ||  ||||||||  |||| |||||| | ||  |   | |  | ||| /-+++-+++++++-+-+++---+--++++++--+-+++-\|||||   | ||||||
||| |   | ||  | |   ||||  |  |||||| |\++++---+-++--++++++++--++++-++++++-+-++--+---+-+--/ ||| | ||| ||||||| | |||   |  ||^|||  | ||| ||||||   | ||||||
||| |   | ||  | |   ||||  \--++++++-+-++++---+-++--+++++/||  |||| |||||| | ||  |   | |    ||| | ||| \++++++-+-+++---+--++++++--+-+/| ||||||   | ||||||
||| |   | ||  | |/--++++-----++++++-+-++++\  | ||  ||||| ||  |||| |||||| | ||  |   | |    ||| | |||  |||||| | |||   |  ||||||  | | | ||||||   | ||||||
||| |   | ||  | ||  ||||     |||||| | |||||  | ||  ||||| ||  |||| |||||| | ||  |   | |    ||| | |||  |||||| | |||   |  ||||||  | | | ||||||   | ||||||
||| |  /+-++--+-++--++++-----++++++-+-+++++--+-++--+++++-++--++++-++++++-+-++--+---+-+\   ||| | |||  |||||| | |||   |  ||||||  | | | ||||||   | ||||||
||| |  || ||  | \+--++++-----++++++-+-+++++--+-++--+++++-++--++++-++++++-+-++--+---+-++---+++-+-+++--/||||| | |||   |  ||||||  | | | ||||||   | ||||||
||| |  || ||  |  |  ||||     |||||| | |||||  | ||  ||||| || /++++-++++++-+-++--+---+-++---+++\| |||   ||||| | |||   |  ||||||  | | | ||||||   | ||||||
||| |  || ||  |  | /++++-----++++++-+-+++++--+-++--+++++-++-+++++-++++++-+-++--+---+-++---+++++-+++--\||||| | ||v   |  ||||||  | | | ||||||   | ||||||
||| |  || ||  |  | |||||     |||||| | |||||  | ||  ||||| || ||||| |||||| | \+--+---+-++---+++++-+++--++++++-+-+++---+--++++++--+-+-+-++++++---+-/|||||
||| |  || ||  |  | |||||     |||||| | |||||  | ||  ||||| |\-+++++-++++++-+--+--+---+-++---+++++-+++--++++++-+-+++---+--++++++--+-+-+-++++++---+--++/||
||| |  || ||  |  | |||||     |||||| | |||||  | ||  ||||| |  ||||| |||||\-+--+--+---+-++---+++++-+++--++++++-+-+++---+--++++++--+-+-+-+/||||   |  || ||
||| |  || ||/-+--+-+++++----\|||||| | |||||  | ||  ||||| |  ||||| |\+++--+--+--+---+-++---+++++-+++--++++++-+-+++---+--++/|||  | | | | ||||   |  || ||
||| | /++-+++-+--+-+++++----+++++++-+-+++++--+-++--+++++-+--+++++-+-+++--+--+--+---+-++---+++++-+++-\|||||| | |||   |  || |||  | | | | ||||   |  || ||
||| | |\+-+++-+--+-+++++----+++++++-+-+++++--+-++--+++++-+--+++++-+-+++--+--+--+---+-+/   ||||| ||| ||||||| |/+++---+--++-+++--+-+-+-+-++++-\ |  || ||
||| | | | ||| |  | |\+++----+++++++-+-+++++--+-++--/|||| |  ||||| | |||  |  |  |   | |    ||||| ||| ||||||| |||||   |  || |||  | | | | |||| | |  || ||
||\-+-+-+-+++-+--+-+-+++----+++++++-+-+++++--+-++---++++-+--+++++-+-+++--+--+--+>--+-+----+++++-+++-++++/|| |||||   |  || |||  | | | | |||| | |  || ||
||  | | | ||| |  | | |||    ||||||| | |||||  | ||   |||| |  ||||| | |||  |  |/-+---+-+----+++++-+++-++++-++-+++++---+--++-+++--+-+-+-+-++++-+-+-\|| ||
|| /+-+-+-+++-+--+-+-+++----+++++++-+-+++++--+-++---++++-+-\|\+++-+-+++--+--++-+---+-+----+++++-+++-++++-++-+++++---+--++-+/|  | | | | |||| | | ||| ||
|| || | \-+++-+--+-+-+++----+++++++-+-+++++--+-++---++++-+-++-+++-+-+++--+--++-+---+-+----+++++-+++-+++/ || |||||   |  || | |  | | | | |||| | | ||| ||
|| || |   ||| |  | | \++----+++++++-+-+++++--+-/|   |\++-+-++-+++-+-+++--+--++-+---+-+----+++++-+++-+++--++-/||||   |  |^ | |  | | | | |||| | | ||| ||
|| ||/+---+++-+--+-+--++----+++++++-+-+++++--+--+---+-++-+-++-+++-+-+++--+--++-+---+-+----+++++-+++\|||  ||  ||||   |  || | |  | | | | |||| | | ||| ||
|| ||||   ||| |  | |  ||    ||||||| | \++++--+--+---+-++-+-++-+++-+-+++--+--++-+---+-+----+++++-++++++/  ||  ||||   |  || | |  | | | | |||| | | ||| ||
|| ||||   ||| |  | |  ||    |||||\+-+--++++--+--+---+-/| | |v ||| | |||  |  || |   | |    ||||| ||||||   ||  ||||   |  || | |  | | | | |||| | | ||| ||
|| ||||   ||| |  | |  \+----+++++-+-+--++++--+--+---/  | | || ||| | |||  |  || |   | |    ||||| ||||||   ||  ||||   |  || | |  | | | | |||| | | ||| ||
|| ||||   ||| |  | |   |    ||||| | |  |\++--+--+------+-+-++-+++-+-+++--+--++-+---+-+----+++++-++++++---++--+/||   |  || | |  | | | | |||| | | ||| ||
|| ||||   ||| |  | |   |    ||||\-+-+--+-++--+--+------+-+-++-+++-+-+++--+--++-+---+-+----++/|| ||||||   ||  | ||   |  || | |  | | | | |||| | | ||| ||
|| ||||   ||| |  | |   |    |\++--+-+--+-++--+--+------+-+-++-+++-+-+++--+--++-+---+-+----++-++-++++++---++--+-++---+--++-/ |  | | | | |||| | | ||| ||
|| ||||   ||| |  | |   |    | ||  | |  | ||  |  |      | | || ||| | |||  |  || |   | |    || || ||||||   ||  | ||   |  ||   |  | | | | |||| | | ||| ||
|| ||||   ||| |  | |   \----+-++--+-+--+-++--+--+------+-+-++-/|| | |||  |/-++-+---+-+----++-++-++++++---++--+-++---+--++---+--+-+-+\| |||| | | ||| ||
|| ||||   ||| |  | |        | ||  | |  | ||  |  |      | | ||  || | |||  || || |   | |    || || ||||||   ||  | ||   |  ||   |  \-+-+++-++/| | | ||| ||
|| ||||   ||| |  | |        | ||  | |  | ||  \--+------+-+-++--++-+-+++--++-++-+---+-+----++-++-++++++---++--+-++---+--+/   |    | ||| || | | | ||| ||
|| |||\---+++-+--+-+--------+-++--+-+--+-++-----+------+-+-++--++-+-+++--++-++-+---+-+----++-++-++++/|   ||  | |\---+--+----/    | ||| || | | | ||| ||
|| |||    ||| |  | |        | ||  | |  | ||     |      | | ||  || | ||| /++-++-+---+\|    || || |||| |   ||  \-+----+--+------>--+-+++-++-+-/ | ||| ||
|| |||    ||| \--+-+--------+-++--+-+--+-++-----+------+-+-++--++-+-+++-+++-++-+---/||    || || |||| |   \+----+----+--+---------+-+++-++-+---+-+/| ||
|| |||    |||    | |        | ||  | |  | ||     |      | | ||  || | ||| ||| || |    ||    || || |||| |    |    |    |  |         | ||| || |   | | | ||
|| |\+----+++----+-+--------+-+/  | |  | ||  /--+------+-+-++--++-+-+++-+++-++-+---\||    || || |||| |    |    |    |  |         | ||| || |   | | | ||
|| | |    |||    | |        | |   | |  | ||  |  |      | | |\--++-+-+++-+++-++-+---+++----++-/| |||| |    |    |    |  |         | ||| || |   | | | ||
|| | |    |||    | |   /----+-+---+-+--+-++-\|  |      | | |   || | ||| ||| || |   |||    ||  | |||| |    |    |    \--+---------+-+++-++-+---+-+-+-/|
|| | |    ||| /--+-+---+----+-+---+-+-\| || ||  |      | | |   |\-+-+++-+++-/| |   |||    ||  | |||| |    \----+-------+---------+-+++-++-+---+-+-+--/
|| | |    ||| |  | |   |    | |   | | || || ||  |      | | |   |  | ||| |||  | |   |||    ||  | |||| |         |       \---------+-+++-/| |   | | |
|| | |  /-+++-+--+-+---+----+-+---+-+-++-++-++--+------+-+-+---+--+-+++-+++--+-+---+++---\||  | |||| |         |                 | |||  | |   | | |
|| | |  | ||| |  | |   |    | |   | | || || ||  |      | | |   |  \-+++-+++--+-+---+++---+++--+-++++-+---------/                 | |||  | |   | | |
|| | |  | ||| |  | |   |    | |   | | || || ||  |      | | |   |    ||| |||  \-+---+++---+++--+-++++-+---------------------------+-+++--+-+---+-/ |
|| | |  | |\+-+--+-+---+----+-+---+-+-+/ || ||  |      | | |   |    ||| |||    |   |||   |\+--+-++++-+---------------------------+-+++--+-+---+---/
|| | |  | | | |  | |   |    | |   | | |  || ||  |      | | |   |    ||| |||    \---+++---+-+--+-++++-+---------------------------+-/||  | |   |
|| | |  | | | |  | |   |    | |   | | |  |v |\--+------+-+-+---+----+++-+++--------/||   | |  \-++++-+---------------------------+--+/  | |   |
\+-+-+--+-+-+-+--+-+---+----+-+---+-+-+--++-+---+------+-+-+---+----+++-+++---------++---+-+----/||| |                           |  |   | |   |
 | | |  | | | |  | |   |    | |   | | |  || |   |      | | |   |    \++-+++---------++---+-+-----+++-+---------------------------/  |   | |   |
 | | |  | | | |  | |   \----+-+---+-+-+--++-/   |      | | |   |     || |||         ||   | |     \++-+------------------------------+---+-/   |
 | | |  | | | |  \-+--------+-+---+-+-+--+/     |      | | |   |     || |||         ||   | |      || |                              |   |     |
 | | |  | | | |    |        | |   | | |  |      |      | | |   |     || |||         ||   | |      \+-+------------------------------+---+-----/
 | | |  | | \-+----+--------/ |   \-+-+--+------/ /----+-+-+---+-----++-+++---------++---+-+-------+-+-\                            |   |
 | | |  | |   |    |          |     | |  \--------+----+-+-+---/     || |||         ||   | |       | | |                            |   |
 | \-+--+-+---+----+----------+-----+-+-----------+----+-+-/         || |||         ||   | |       | | |                            |   |
 |   |  | |   |    |          |     \-+-----------+----+-/           || \++---------/|   | |       | | |                            |   |
 |   |  | |   |    |          \-------+-----------+----+-------------++--++----------/   | |       | | |                            |   |
 |   |  | |   |    \------------------+>----------+----+-------------++--++----------->--+-+-------+-/ |                            |   |
 |   |  | \---+-----------------------+-----------+----/             ||  \+--------------+-/       |   |                            |   |
 |   |  \-----+-----------------------+-----------+------------------++---+--------------/         |   |                            |   |
 |   |        \-----------------------/           |                  ||   \------------------------+---+----------------------------/   |
 |   \--------------------------------------------+------------------++----------------------------/   |                                |
 |                                                |                  \+------------------------------>-+--------------------------------/
 \------------------------------------------------+-------------------/                                |
                                                  \----------------------------------------------------/                                              """
